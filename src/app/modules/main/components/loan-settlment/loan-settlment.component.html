<div class="w-full bg-white" *ngIf="!showForm">
    <div class="p-8 rounded-xl shadow-sm mx-auto">
        <h2 class="text-2xl font-semibold mb-2">تسویه تسهیلات</h2>
    </div>
</div>

<div class="p-6 space-y-6 rounded-2xl" *ngIf="!showForm">
    <div [formGroup]="form" class="bg-white p-6 rounded-xl border border-slate-200">

        <p-table [value]="customerTable" styleClass="p-datatable-striped p-datatable-gridlines">
            <ng-template pTemplate="caption">
                <div class="flex justify-between">
                    <h3 class="text-base font-semibold">اطلاعات مشتری</h3>
                </div>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th>ردیف</th>
                    <th>شماره مشتری</th>
                    <th>نام مشتری</th>
                    <th>کد/شناسه ملی</th>
                    <th>تابعیت</th>
                    <th>نوع</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row let-index="rowIndex">
                <tr>
                    <td>{{ index + 1 }}</td>
                    <td>{{ row.customerNumber }}</td>
                    <td>{{ row.customerName }}</td>
                    <td>{{ row.nationalId }}</td>
                    <td>{{ row.citizenship }}</td>
                    <td>{{ row.type }}</td>
                </tr>
            </ng-template>
        </p-table>

        <p-table [value]="contractTable" styleClass="p-datatable-striped p-datatable-gridlines">
            <ng-template pTemplate="caption">
                <h3 class="text-base font-semibold">اطلاعات قرارداد</h3>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th>ردیف</th>
                    <th>شماره قرارداد</th>
                    <th>وضعیت قرارداد</th>
                    <th>تاریخ ثبت</th>
                    <th>تاریخ سررسید</th>
                    <th>جمع مبلغ پرداختی تاکنون</th>
                    <th>حساب سپرده</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row let-index="rowIndex">
                <tr>
                    <td>{{ index + 1 }}</td>
                    <td>{{ row.contractNumber }}</td>
                    <td>{{ row.contractStatus }}</td>
                    <td>{{ row.createdDate }}</td>
                    <td>{{ row.dueDate }}</td>
                    <td>{{ row.totalPaid }}</td>
                    <td>{{ row.depositAccount }}</td>
                </tr>
            </ng-template>
        </p-table>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-10">

            <!-- تاریخ مؤثر -->
            <div class="flex flex-col">
                <label class="mb-1 font-medium">تاریخ مؤثر:</label>
                <input pInputText readonly class="normal-input" formControlName="date">
            </div>
        </div>

        <p-table
            [value]="paymentBreakdownTable"
            styleClass="p-datatable-striped p-datatable-gridlines mt-6">

            <ng-template pTemplate="caption">
                <h3 class="text-base font-semibold">ریز بازپرداخت</h3>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th>مبلغ بابت</th>
                    <th>بازپرداختی</th>
                    <th>مانده بدهی</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
                <tr>
                    <td>{{ row.title }}</td>
                    <td>{{ row.paid }}</td>
                    <td>{{ row.remaining }}</td>
                </tr>
            </ng-template>

        </p-table>

    </div>
</div>

<div class="bg-white p-4 rounded-xl border border-slate-200 mt-3">
    <div class="grid grid-cols-12 gap-3 md:gap-4 items-start justify-start " dir="ltr">

        <button
            pButton
            label="انصراف"
            severity="danger"
            type="button"
            class="p-button-secondary col-span-2 md:col-span-2 h-[38px]"
            (click)="onCancelClick()"
        ></button>

        <button
            pButton
            label="ذخیره"
            severity="success"
            type="button"
            class="p-button-primary col-span-2 md:col-span-2 h-[38px]"
            (click)="onSubmitClick()"
        ></button>

    </div>
</div>
