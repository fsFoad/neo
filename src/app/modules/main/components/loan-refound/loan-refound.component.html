<div class="w-full bg-white" *ngIf="!showForm">
    <div class="p-8 rounded-xl shadow-sm mx-auto">
        <h2 class="text-2xl font-semibold mb-2">بازپرداخت تسهیلات</h2>
    </div>
</div>

<div class="p-6 space-y-6 rounded-2xl" *ngIf="!showForm">
    <div [formGroup]="form" class="bg-white p-6 rounded-xl border border-slate-200">

        <p-table [value]="customerTable"  styleClass="normal-table"
                 class="p-6 space-y-6">
            <ng-template pTemplate="caption">
                <div class="flex justify-between">
                    <h3 class="text-base font-semibold">اطلاعات مشتری</h3>
                </div>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th>ردیف</th>
                    <th>شماره مشتری</th>
                    <th>نام مشتری</th>
                    <th>کد/شناسه ملی</th>
                    <th>تابعیت</th>
                    <th>نوع</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row let-index="rowIndex">
                <tr>
                    <td>{{ index + 1 }}</td>
                    <td>{{ row.customerNumber }}</td>
                    <td>{{ row.customerName }}</td>
                    <td>{{ row.nationalId }}</td>
                    <td>{{ row.citizenship }}</td>
                    <td>{{ row.type }}</td>
                </tr>
            </ng-template>
        </p-table>

        <p-table [value]="contractTable"  styleClass="normal-table"
                 class="p-6 space-y-6">
            <ng-template pTemplate="caption">
                <h3 class="text-base font-semibold">اطلاعات قرارداد</h3>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th>ردیف</th>
                    <th>شماره قرارداد</th>
                    <th>وضعیت قرارداد</th>
                    <th>تاریخ ثبت</th>
                    <th>تاریخ سررسید</th>
                    <th>جمع مبلغ پرداختی تاکنون</th>
                    <th>شعبه صاحب تسهیلات</th>
                    <th>حساب سپرده</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row let-index="rowIndex">
                <tr>
                    <td>{{ index + 1 }}</td>
                    <td>{{ row.contractNumber }}</td>
                    <td>{{ row.contractStatus }}</td>
                    <td>{{ row.createdDate }}</td>
                    <td>{{ row.dueDate }}</td>
                    <td>{{ row.totalPaid }}</td>
                    <td>{{ row.branch }}</td>
                    <td>{{ row.depositAccount }}</td>
                </tr>
            </ng-template>
        </p-table>
        <div class="my-10 mb-4">
            <button
                pButton
                icon="pi pi-plus"
                class="p-button-primary normal-button"
                type="button"
                label="بازپرداخت"
                (click)="openRefoundDialog()"
            ></button>
        </div>
        <p-table
            [value]="paymentBreakdownTable"
            styleClass="normal-table"
            class="p-6 space-y-6">

            <ng-template pTemplate="caption">
                <h3 class="text-base font-semibold">ریز بازپرداخت</h3>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th>مبلغ بابت</th>
                    <th>بازپرداختی</th>
                    <th>مانده بدهی</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
                <tr>
                    <td>{{ row.title }}</td>
                    <td>{{ row.paid }}</td>
                    <td>{{ row.remaining }}</td>
                </tr>
            </ng-template>

        </p-table>

    </div>
</div>


<div *ngIf="showForm">
    <app-loan-refound-information
        (formSubmit)="onFormSubmit($event)"
        (cancel)="onFormCancel()">
    </app-loan-refound-information>
</div>
